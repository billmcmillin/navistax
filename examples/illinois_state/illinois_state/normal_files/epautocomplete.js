var ep = window.ep || {}; ep.bundles = ep.bundles || []; ep.bundles = ep.bundles.concat('bundled/epautocomplete.js','ep/widgets/epautocomplete/epautocomplete.js', 'ep/widgets/epautocomplete/epautocomplete-ehost.js');
(function(b){ep.require("ep/jqueryplugins/bididirfixer.js",function(){b.widget("ui.epautocomplete",{options:{data:{url:"autosuggest",termKey:"term",queryParams:{},massageData:false,searchOnSelect:false,highlightClass:null,truncateClass:"auto-complete-truncate",noWrapClass:"auto-complete-no-wrap",completions:{wrap:true,truncate:false,maxWidth:70},handlePrototype:false,ajaxHandler:function(){},jQueryOverrides:{}}},_create:function(){var h=this,a=b(this.element),f=b.extend({},this.options.data),g=f.handlePrototype?ep.util.JSON.stringify:JSON.stringify;a.autocomplete(b.extend({source:function(c,d){f.queryParams[f.termKey]=c.term;b.each(f.queryParams,function(l,k){var e=this;if(b.isPlainObject(e)){f.queryParams[l]=g(e)}else{if(b.isArray(e)){f.queryParams[l]=g(e)}}});f.ajaxHandler.call(this,c,d,f.queryParams,function(e){var l=e.error;if(!l){if(f.massageData){var k=(function(){var i=[];if(e.terms){if(e.terms.length){i=b.map(e.terms,function(j){return{value:j.term,fragments:j.fragments}})}else{i.push(e.terms.term)}}return i})();d(k)}else{d(e)}}})},open:function(e,d){var c=b(this),l=c.autocomplete("widget"),m={},n=f.completions;l.find("a").bidiDirFixer();b(this).bidiDirFixer();m.minWidth=c.innerWidth();l.addClass(f.highlightClass);if(n.truncate){m.maxWidth=n.maxWidth+"%"}if(!n.wrap){m.width="auto";l.addClass(f.noWrapClass)}if(b('html[dir="rtl"]').length>0){m.left="auto";m.right=(b(window).width()-(c.offset().left+c.outerWidth()))+"px"}l.css(m);if(b.browser.msie&&parseInt(b.browser.version,10)<8){l.width(l.width())}b(window).on("resize",function(){l.css(m)})},close:function(d,c){b(this).autocomplete("widget").removeClass(f.highlightClass)},select:function(d,c){if(f.searchOnSelect){a.val(c.item.value);b("[id$='SearchButton']").click()}}},f.jQueryOverrides));a.data("autocomplete")._renderItem=function(e,c){var d=function(i){var l=(f.completions.truncate)?f.truncateClass:"";return b("<li></li>").data("item.autocomplete",c).append(b("<a class='"+l+"'></a>").html(i)).appendTo(e)};if(f.massageData){var j=function(){var l=c.fragments,i="";if(l){b.each(l,function(){var k=(f.highlightClass)?'<strong class="'+f.highlightClass+'">':"<strong>";if(this.user===true){i+=k+this.text+"</strong>"}else{i+=this.text}})}else{i=c.value}return i};return d(j())}else{return d(c.value)}}},_init:function(){},destroy:function(){b.Widget.prototype.destroy.call(this)}})})})(jQuery);(function(b){b(function(){ep.require("ep/widgets/epautocomplete/epautocomplete.js",function(){var h=8,g=10;function a(e,c){var d=b("[data-auto-complete]");d.each(function(){var n=b(this),m=(n.prop("tagName")==="INPUT")?n:n.find("input.auto-complete"),o,p=b.noop;if(window.Prototype){p=Array.prototype.toJSON;Array.prototype.toJSON=null}o=b.extend(true,{},n.data("auto-complete"));if(window.Prototype){Array.prototype.toJSON=p}if(e){o.queryParams.idx=e.queryParams.idx}if(o){o.handlePrototype=true;o.ajaxHandler=function(j,l,k,i){b.get(o.url,k,function(r){i(r)},"json")};if(c){m.epautocomplete("destroy")}m.epautocomplete({data:o})}})}ep.subscribe("ep:autosuggest:limiter",function(e){var c=e.curSelected,d=ep.utilities.buildAjaxRequestPath("AutoComplete/GetSettings");if(c!==e.defaultId){b.ajax({url:d,data:{contentType:c},success:function(j){if(_.isString(j)){j=JSON.parse(j)}a(j,true)}})}else{a(null,true)}return false});function f(){try{a()}catch(c){if(--h){setTimeout(f,g);g*=2}}}f()})})})(jQuery);